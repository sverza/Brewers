<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Roster - Brewers</title>
  <link href="https://fonts.cdnfonts.com/css/strike-fighter-laser" rel="stylesheet">
  <style>
    /* --- RESET come pagina Sponsor --- */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; width:100%; max-width:100%; overflow-x: hidden; }
    img, svg { display:block; max-width:100%; height:auto; }
    a { color: inherit; text-decoration: none; }
    button { border: none; background: none; color: inherit; cursor: pointer; }

    /* --- Stili pagina --- */
    body { font-family: 'Inter', sans-serif; background:#000; color:#fff; }

    /* container dell'header: nessuna regola che interferisca con l'off-canvas */
    #header-container { position: sticky; top: 0; z-index: 1000; background:#090909; width:100%; }

    .section-title {
      font-family: 'Strike Fighter Laser', sans-serif;
      font-size: 2.5rem; margin: 2rem 1rem 1rem;
    }

    .filters {
      margin: 0 1rem 1rem;
      display: flex; flex-wrap: wrap; gap: 1rem;
      overflow-x: auto; -webkit-overflow-scrolling: touch; /* evita allargamenti su mobile */
    }
    .filters button {
      background: #222; color: white; font-family: 'Strike Fighter Laser', sans-serif;
      border: none; padding: 0.5rem 1rem; border-radius: 6px; transition: background .3s;
      white-space: nowrap;
    }
    .filters button.active, .filters button:hover { background: #0af; }

    .grid {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem; padding: 0 1rem 1rem;
    }

    .card {
      position: relative; border-radius: 12px; overflow: hidden;
      background-size: cover; background-position: center; height: 300px;
      display: flex; align-items: flex-end;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      transform: scale(1);
      transition: transform .3s ease, box-shadow .3s ease;
    }
    .card:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(0,0,0,0.7); }

    .card::before {
      content: ""; position: absolute; inset: 0; background: rgba(0,0,0,0.5); transition: background .2s;
    }
    .card:hover::before { background: rgba(0,0,0,0.35); }

    .card-content { position: relative; z-index: 1; padding: 1rem; font-family: 'Strike Fighter Laser', sans-serif; }
    .card-content .number { font-size: 2rem; margin-bottom: 0.5rem; }
    .card-content .name { font-size: 1.25rem; line-height: 1.4; }
    .card-content .role { font-family: 'Inter', sans-serif; font-size: 1rem; opacity: 0.9; }

    .empty-msg {
      margin: 0 1rem 2rem; padding: 0.85rem 1rem;
      border: 1px dashed #3aa9ff; border-radius: 10px;
      color: #9AD7F3; background: rgba(0,85,170,.08);
      font-family: 'Strike Fighter Laser', sans-serif; letter-spacing: .5px;
    }

    @media (max-width: 768px) {
      .grid { grid-template-columns: repeat(2, 1fr); }
      .card { height: 220px; }
      .filters button { font-size: .8rem; padding: .3rem .6rem; }
      .card-content .number { font-size: 1.5rem; }
      .card-content .name { font-size: 1rem; }
      .card-content .role { font-size: .9rem; }
    }
  </style>
</head>
<body>

  <div id="header-container"></div>

  <h3 class="section-title">STAFF</h3>
  <section class="grid" id="staff-grid"></section>
  <div id="staff-empty-msg" class="empty-msg" style="display:none;" aria-live="polite">Nuovi Annunci in arrivo</div>

  <h3 class="section-title">GIOCATORI</h3>
  <div class="filters" id="role-filters"></div>
  <section class="grid" id="players-grid"></section>
  <div id="players-empty-msg" class="empty-msg" style="display:none;" aria-live="polite">Nuovi Annunci in arrivo</div>

  <h3 class="section-title">HONORARY MEMBERS</h3>
  <div class="filters" id="role-filters"></div>
  <section class="grid" id="honorary_members-grid"></section>
  <div id="honorary_members-empty-msg" class="empty-msg" style="display:none;" aria-live="polite">Nuovi Annunci in arrivo</div>

  <div id="footer-container"></div>

  <script>
    fetch('https://raw.githubusercontent.com/sverza/Brewers/main/widget/brewers_header.html')
      .then(r=>{ if(!r.ok) throw new Error('Errore header'); return r.text(); })
      .then(html=>{
        document.getElementById('header-container').innerHTML=html;
        const icon = document.getElementById('menu-icon');
        const iconFixed = document.getElementById('menu-icon-fixed');
        const menu = document.getElementById('brewers-menu');
        const overlay = document.getElementById('menu-overlay');
        function toggleMenu(){
          if(!menu||!overlay) return;
          const opening = !menu.classList.contains('open');
          menu.classList.toggle('open');
          overlay.classList.toggle('active');
          if(icon) icon.classList.add('bounce');
          if(iconFixed) iconFixed.classList.add('bounce');
          setTimeout(()=>{ icon&&icon.classList.remove('bounce'); iconFixed&&iconFixed.classList.remove('bounce'); },500);
          if(iconFixed) iconFixed.style.display = opening ? 'block' : 'none';
        }
        icon && icon.addEventListener('click', toggleMenu);
        iconFixed && iconFixed.addEventListener('click', toggleMenu);
        overlay && overlay.addEventListener('click', ()=>{
          menu && menu.classList.remove('open');
          overlay && overlay.classList.remove('active');
          if(iconFixed) iconFixed.style.display='none';
        });
      })
      .catch(err=>console.error('Header:',err));
    
    fetch('https://raw.githubusercontent.com/sverza/Brewers/main/widget/brewers_footer.html')
      .then(r=>r.text()).then(d=>document.getElementById('footer-container').innerHTML=d);

    let roster = {};

    fetch('roster/brewers_roster.json')
      .then(response => {
        if (!response.ok) throw new Error('Errore nel caricamento del JSON');
        return response.json();
      })
      .then(data => {
        roster = data || { staff: [], players: [] , honorary_members: []};
        roster.staff = Array.isArray(roster.staff) ? roster.staff : [];
        roster.players = Array.isArray(roster.players) ? roster.players : [];
        roster.honorary_members = Array.isArray(roster.honorary_members) ? roster.honorary_members : [];
        renderStaff(); renderPlayers(); renderHonoraryMembers(); renderFilters();
      })
      .catch(error => {
        console.error("Errore nel caricamento del roster:", error);
        document.getElementById('staff-grid').innerHTML = '';
        document.getElementById('players-grid').innerHTML = '';
        document.getElementById('honorary_members-grid').innerHTML = '';
        document.getElementById('staff-empty-msg').style.display = 'block';
        document.getElementById('players-empty-msg').style.display = 'block';
        document.getElementById('honorary_members-empty-msg').style.display = 'block';
      });

    function renderStaff() {
      const grid = document.getElementById('staff-grid');
      const msg = document.getElementById('staff-empty-msg');
      grid.innerHTML = '';
      if (!roster.staff.length) { msg.style.display = 'block'; return; }
      msg.style.display = 'none';
      roster.staff.forEach(p => {
        grid.innerHTML += `
          <div class="card" style="background-image:url('${p.image}')">
          <a href="https://brewersbasketball.it/staff_details.html?giocatore=${p.idpl}">
            <div class="card-content">
              <div class="name">${p.name}</div>
              <div class="role">${p.role}</div>
            </div>
          </div>`;
      });
    }

    function renderPlayers(filterRole='all') {
      const grid = document.getElementById('players-grid');
      const msg = document.getElementById('players-empty-msg');
      grid.innerHTML = '';
      if (!roster.players.length) { msg.style.display = 'block'; return; }
      msg.style.display = 'none';
      roster.players
        .filter(p => filterRole==='all' || (p.role||'').toLowerCase()===filterRole.toLowerCase())
        .forEach(p => {
          grid.innerHTML += `
            <div class="card" style="background-image:url('${p.image}')">
              <a href="https://brewersbasketball.it/roster_details.html?giocatore=${p.idpl}">
                <div class="card-content">
                  <div class="number">${p.number}</div>
                  <div class="name">${p.name}</div>
                  <div class="role">${p.role}</div>
                </div>
              </a>
            </div>`;
        });
    }

    function renderHonoraryMembers(filterRole='all') {
      const grid = document.getElementById('honorary_members-grid');
      const msg = document.getElementById('honorary_members-empty-msg');
      grid.innerHTML = '';
      if (!roster.honorary_members.length) { msg.style.display = 'block'; return; }
      msg.style.display = 'none';
      roster.honorary_members
        .filter(p => filterRole==='all' || (p.role||'').toLowerCase()===filterRole.toLowerCase())
        .forEach(p => {
          grid.innerHTML += `
            <div class="card" style="background-image:url('${p.image}')">
              <a href="https://brewersbasketball.it/roster_details.html?giocatore=${p.idpl}">
                <div class="card-content">
                  <div class="number">${p.number}</div>
                  <div class="name">${p.name}</div>
                  <div class="role">${p.role}</div>
                </div>
              </a>
            </div>`;
        });
    }

    function renderFilters() {
      const roles = ['all', ...new Set((roster.players||[]).map(p=>p.role).filter(Boolean))];
      const wrap = document.getElementById('role-filters');
      wrap.innerHTML = '';
      if (!roster.players.length) return;
      roles.forEach(role => {
        const btn = document.createElement('button');
        btn.textContent = role;
        btn.classList.toggle('active', role==='all');
        btn.setAttribute('aria-pressed', role==='all' ? 'true' : 'false');
        btn.addEventListener('click', () => {
          document.querySelectorAll('.filters button').forEach(b => {
            b.classList.remove('active'); b.setAttribute('aria-pressed','false');
          });
          btn.classList.add('active'); btn.setAttribute('aria-pressed','true');
          renderPlayers(role);
        });
        wrap.appendChild(btn);
      });
    }
  </script>
</body>
</html>
