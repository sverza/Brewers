<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Risultato Partita - Desktop</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    /* same CSS as before... omitted for brevity */
  </style>
</head>
<body>
  <div id="header-container"></div>
  <div class="container">
    <div class="left-panel">
      <div class="teams" id="teams-container"></div>
      <div class="stats">
        <div class="stats-row highlight">
          <div class="stat-name">Giocatore</div>
          <div class="stat">MIN</div>
          <div class="stat">PTS</div>
          <div class="stat">REB</div>
          <div class="stat">AST</div>
        </div>
        <div id="players-stats"></div>
      </div>
    </div>

    <div class="right-panel" id="right-panel"></div>
  </div>
  <div id="footer-container"></div>

  <script>
    // Load header and footer
    fetch('https://raw.githubusercontent.com/sverza/Brewers/main/widget/brewers_header.html')
      .then(r => r.text()).then(data => {
        document.getElementById('header-container').innerHTML = data;

        const icon = document.getElementById("menu-icon");
        const iconFixed = document.getElementById("menu-icon-fixed");
        const menu = document.getElementById("brewers-menu");
        const overlay = document.getElementById("menu-overlay");

        function toggleMenu() {
          const isOpening = !menu.classList.contains("open");
          menu.classList.toggle("open");
          overlay.classList.toggle("active");

          icon.classList.add("bounce");
          iconFixed.classList.add("bounce");

          setTimeout(() => {
            icon.classList.remove("bounce");
            iconFixed.classList.remove("bounce");
          }, 500);

          if (isOpening) {
            setTimeout(() => { iconFixed.style.display = "block"; }, 300);
          } else {
            iconFixed.style.display = "none";
          }
        }

        icon?.addEventListener("click", toggleMenu);
        iconFixed?.addEventListener("click", toggleMenu);
        overlay?.addEventListener("click", () => {
          menu.classList.remove("open");
          overlay.classList.remove("active");
          iconFixed.style.display = "none";
        });
      });

    fetch('https://raw.githubusercontent.com/sverza/Brewers/main/widget/brewers_footer.html')
      .then(r => r.text()).then(data => {
        document.getElementById('footer-container').innerHTML = data;
      });

    // Load JSON data
    const params = new URLSearchParams(window.location.search);
    const partita = params.get("partita");

    if (partita) {
      fetch(`/partite/${partita}.json`)
        .then(res => res.json())
        .then(data => {
          // Teams
          document.getElementById("teams-container").innerHTML = `
            <div class="team">
              <img src="${data.team1.logo}" alt="Logo ${data.team1.name}">
              <div class="team-name">${data.team1.name}</div>
              <div class="team-record">${data.team1.record}</div>
            </div>
            <div>
              <div class="score">${data.score}</div>
              <div class="final">${data.final}</div>
            </div>
            <div class="team">
              <img src="${data.team2.logo}" alt="Logo ${data.team2.name}">
              <div class="team-name">${data.team2.name}</div>
              <div class="team-record">${data.team2.record}</div>
            </div>
          `;

          // Players
          const statsContainer = document.getElementById("players-stats");
          statsContainer.innerHTML = data.players.map(p => `
            <div class="stats-row">
              <div class="stat-name">${p.name}</div>
              <div class="stat">${p.min}</div>
              <div class="stat">${p.pts}</div>
              <div class="stat">${p.reb}</div>
              <div class="stat">${p.ast}</div>
            </div>
          `).join('');

          // Right Panel Cards
          const panel = document.getElementById("right-panel");
          if (data.article?.link) {
            panel.innerHTML += `
              <a class="card" href="${data.article.link}">
                <img src="${data.article.image}" alt="Articolo post-partita">
                <div class="card-content">
                  <div class="card-title">${data.article.title}</div>
                  <div class="card-text">${data.article.description}</div>
                </div>
              </a>
            `;
          }
          if (data.youtube?.link) {
            panel.innerHTML += `
              <a class="card" href="${data.youtube.link}" target="_blank">
                <img src="${data.youtube.image}" alt="Video YouTube">
                <div class="card-content">
                  <div class="card-title">${data.youtube.title}</div>
                  <div class="card-text">${data.youtube.description}</div>
                </div>
              </a>
            `;
          }
        })
        .catch(err => {
          console.error("Errore nel caricamento dei dati:", err);
        });
    } else {
      console.warn("Parametro ?partita mancante nell'URL.");
    }
  </script>
</body>
</html>
