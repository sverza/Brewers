<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Articoli - Basket Group Beers</title>
  <link href="https://fonts.googleapis.com/css2?family=Quattrocento&family=Quattrocento+Sans:wght@400;700&display=swap" rel="stylesheet">
  <style>
    @font-face {
      font-family: 'Strike Fighter Laser';
      src: url('https://raw.githubusercontent.com/sverza/Brewers/main/Font/strikefighterlaser.ttf') format('truetype');
    }

    :root{
      --bg:#0a0a0a;
      --panel:#0f1115;
      --panel-2:#12151b;
      --text:#f0f0f0;
      --muted:#c7c9cc;
      --muted-2:#9aa0a6;
      --brand:#00aaff;
      --brand-2:#66fcf1;
      --accent:#45a29e;
      --ring: rgba(0,170,255,.35);
      --shadow: 0 6px 24px rgba(0,0,0,.45), 0 1px 0 rgba(255,255,255,.02) inset;
      --radius: 16px;
    }

    body { margin:0; background:var(--bg); font-family:'Quattrocento Sans',sans-serif; color:var(--text); }

    #header-container{position:sticky;top:0;z-index:1000;background:#090909;backdrop-filter:blur(8px);border-bottom:1px solid rgba(255,255,255,.06)}

    .container{max-width:1100px;margin:auto;padding:24px}

    h2{font-family:'Strike Fighter Laser',sans-serif;font-size:clamp(22px,3vw,32px);text-align:center;margin:1.2rem 0 1rem;color:#fff}

    .filters{display:flex;gap:12px;align-items:center;justify-content:flex-end;flex-wrap:wrap;margin-bottom:1rem}
    select{background:linear-gradient(180deg,var(--panel),var(--panel-2));color:var(--text);padding:10px 12px;border:1px solid var(--brand);border-radius:10px}
    .toggle-btn{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid rgba(255,255,255,.12);color:var(--text);padding:10px 12px;border-radius:10px;font-weight:800;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
    .toggle-btn[aria-pressed="true"]{border-color:var(--brand);background:linear-gradient(180deg,var(--brand),#0085c7);color:#fff}

    .articles-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px}
    .articles-list{display:flex;flex-direction:column;gap:18px}

    .article-card{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column;transition:.2s}
    .article-card:hover{transform:translateY(-2px);border-color:var(--ring)}

    .articles-list .article-card{flex-direction:row;gap:14px;}
    .articles-list .article-cover{width:260px;height:auto;object-fit:cover}

    .article-cover{width:100%;height:200px;object-fit:cover;background:#0b0c10}

    .card-body{padding:14px;display:flex;flex-direction:column;gap:10px;flex:1}
    .chip{font-size:.75rem;font-weight:700;padding:6px 10px;border-radius:999px;background:rgba(0,170,255,.15);color:var(--brand)}
    .article-title{font-size:1.1rem;font-weight:800}
    .article-excerpt{font-size:.95rem;color:var(--muted)}
    .card-footer{margin-top:auto;display:flex;justify-content:space-between;align-items:center}
    .article-date{font-size:.85rem;color:var(--muted-2)}
    .read-button{background:linear-gradient(180deg,var(--brand),#0085c7);color:#fff;border:none;padding:.5rem .9rem;border-radius:8px;font-weight:700;cursor:pointer}
  </style>
</head>
<body>
  <div id="header-container"></div>

  <div class="container">
    <h2>Ultimi Articoli</h2>
    <section class="carousel-section"><div class="carousel-container" id="carousel-container"></div></section>

    <h2>Tutti gli Articoli</h2>
    <div class="filters">
      <select id="filter-category">
        <option value="all">Tutte le categorie</option>
        <option value="report_partita">Report</option>
        <option value="mercato">Mercato</option>
        <option value="general">Generale</option>
      </select>
      <button id="viewToggle" class="toggle-btn" aria-pressed="false"><span class="emoji">ðŸ”³</span><span class="label">Griglia</span></button>
    </div>

    <div id="articles" class="articles-grid"></div>

    <div class="pagination">
      <button id="prevPage">Â«</button>
      <span id="pageNumber">1</span>
      <button id="nextPage">Â»</button>
    </div>
  </div>

  <div id="footer-container"></div>

  <script>
    const articlesPerPage=12;let allArticles=[],currentPage=1;let isGrid=(localStorage.getItem('viewMode')||'grid')==='grid';

    function applyView(){
      const c=document.getElementById('articles');
      c.classList.toggle('articles-grid',isGrid);
      c.classList.toggle('articles-list',!isGrid);
      const btn=document.getElementById('viewToggle');
      if(btn){btn.setAttribute('aria-pressed',(!isGrid).toString());btn.querySelector('.label').textContent=isGrid?'Griglia':'Lista';btn.querySelector('.emoji').textContent=isGrid?'ðŸ”³':'ðŸ“„'}
    }

    document.getElementById('viewToggle').addEventListener('click',()=>{isGrid=!isGrid;localStorage.setItem('viewMode',isGrid?'grid':'list');applyView();});

    async function fetchArticlesFromGitHub(){
      const res=await fetch("https://api.github.com/repos/sverza/Brewers/contents/articoli_per_news");
      const data=await res.json();
      const jsonFiles=data.filter(f=>f.name.endsWith(".json"));
      const articlePromises=jsonFiles.map(file=>fetch(file.download_url).then(r=>r.json()).then(j=>({title:j.title,excerpt:j.short_description,date:j.date,category:j.category||'general',image:`articoli_per_news/images/${j.img_name}`,link:`testpagearticle.html?articolo=${file.name.replace('.json','')}`})));
      allArticles=await Promise.all(articlePromises);
      renderArticles();
    }

    function renderArticles(){
      const filter=document.getElementById('filter-category').value;
      const filtered=allArticles.filter(a=>filter==='all'||a.category===filter).sort((a,b)=>new Date(b.date)-new Date(a.date));
      const start=(currentPage-1)*articlesPerPage,end=start+articlesPerPage;
      const visible=filtered.slice(start,end);
      document.getElementById('articles').innerHTML=visible.map(a=>`
        <article class="article-card" data-category="${a.category}">
          <img src="${a.image}" class="article-cover" alt="">
          <div class="card-body">
            <span class="chip">${a.category}</span>
            <h3 class="article-title">${a.title}</h3>
            <p class="article-excerpt">${a.excerpt}</p>
            <div class="card-footer">
              <time class="article-date">${a.date}</time>
              <a href="${a.link}"><button class="read-button">Leggi</button></a>
            </div>
          </div>
        </article>`).join('');
      document.getElementById('prevPage').disabled=currentPage===1;
      document.getElementById('nextPage').disabled=end>=filtered.length;
      document.getElementById('pageNumber').textContent=currentPage;
      applyView();
    }

    document.getElementById('filter-category').addEventListener('change',()=>{currentPage=1;renderArticles();});
    document.getElementById('prevPage').addEventListener('click',()=>{if(currentPage>1){currentPage--;renderArticles();}});
    document.getElementById('nextPage').addEventListener('click',()=>{currentPage++;renderArticles();});

    fetchArticlesFromGitHub();
  </script>
</body>
</html>
